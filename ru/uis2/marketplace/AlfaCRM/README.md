## Интеграция с AlfaCRM <br />

Решение позволяет передавать в наш кабинет данные по лидам/платежам в качестве сделок, для дальнейшего построения Сквозной аналитики. <br />

**Какие данные передаются** <br />  
Данные передаваемые по текстовым коммуникациям:  <br />

- возможность гибкой настройки создания лидов по обращениям;
- создание задач по пропущенным чатам;
- передача дополнительных полей в лид;
- встройка нашего виджета РМО в кабинет AlfaCRM при подключении соответствующего расширения. <br />

Данные получаемые по сделкам:  <br /> 
- сделки: лиды, статусы , платежи и тд ;
- 2 воронки: "Первая продажа" (лиды) и "Допродажи" (платежи после перехода лида в клиента);
- контакты;
- дополнительные поля: учитель, филиал.  <br />


## Подключение передачи сделок   <br />  
<details>
 <summary style="font-weight:bold;"> Шаги по подключению </summary> <br />

1. Нажмите "Активен" на этой странице. <br />
2. Настройте **Webhook** в AlfaCRM <br />

<details>
  <summary style="font-weight:bold;"> Подробнее </summary> <br />

ЛК AlfaCRM -> Настройки -> Автодействия и рассылки -> Триггеры и вебхуки (настраивается по каждому филиалу отдельно)  <br />

- Необходимо добавить 2 триггера по Клиенту и Платежу (Целевая сущность).
  - Выбираете все события.
  - Затронутые поля - любые.
  - Реакция - Webhook.
  - Webhook URL - берете из настроек интеграции.
  - Нажмите "Сохранить".

![image](alfa_hook.gif)

</details> 

<br />  

3. **Авторизация** в AlfaCRM <br />

<details>
  <summary style="font-weight:bold;"> Подробнее </summary> <br />

- **Название**  — укажите название авторизации.
- **hostname**  —  YOURDOMAIN замените на домен, от своего кабинета в AlfaCRM.
- **api_key**  — укажите Ключ API (v2api), из личного кабинета AlfaCRM. (Профиль -> Ключ API (v2api) , от админского ЛК)
- **email**   — укажите email, из личного кабинета AlfaCRM. (Профиль -> E-mail , от админского ЛК)

![image](alfa_auth.gif)

</details> 
<br /> 

4. Заполните настройки воронки продаж "Первая продажа": 

- **Успешный этап**  — выберете этап(ы) воронки , которые считаются завершающими успешными в AlfaCRM (в нашем сервисе они будут объединены в один этап).
- **Отказной этап**  — выберете этап(ы) воронки , которые считаются завершающими неуспешными(отказными) в AlfaCRM (в нашем сервисе они будут объединены в один этап).
<br />

5. Нажмите сохранить. <br />


После подключения интеграции сделки будут попадать в  Сырые данные -> Сделки.  <br />
Для проверки корректности работы интеграции создайте тестовый лид в AlfaCRM.   
</details> 
<br />
<br />
<br />
<br />
<br />
<br />
<br />

## Подключение текстовых коммуникаций   <br />  

<details>
 <summary style="font-weight:bold;"> Шаги по подключению </summary> <br />  
  
1. Укажите **Учетные данные** <br /> 
Добавьте название авторизации, адрес вашего портала, API ключ и email учетной записи.  <br />    
2. Укажите необходимый для работы филиал. <br /> 
3. **Передача заявок**  <br />
3.1. **Передавать заявки** - выберите настройку, если требуется передавать данные по заявкам в AlfaCRM.
При её выборе выводятся дополнительные настройки вариантов передачи заявок. <br />
3.2. **Условия фильтрации** - задайте условия, если требуется фильтровать заявки по сайтам и/или типам.<br />
3.3. **Создавать лид по обращению** - настройка позволяет создавать лид по заявкам. <br />
3.4. **Передавать дополнительные поля** - настройка позволяет передавать дополнительные поля в лид. <br />
При её выборе выводятся дополнительные настройки выбора сущности в AlfaCRM и соответствия их полей в AlfaCRM и UIS.
Добавьте все требуемые значения. Если требуется передавать значение в поля не только при первичных чатах (при создании клиента), но и при повторных, выберите настройку "Обновлять всегда".  <br />

4. **Передача чатов**  <br />
4.1. **Передавать чаты** - выберите настройку, если требуется передавать данные по чатам в AlfaCRM.
При её выборе выводятся дополнительные настройки вариантов передачи чатов.  <br />
4.2. **Условия фильтрации** - задайте условия, если требуется фильтровать чаты по сайтам, каналам и/или тегам.  <br />
4.3.**Создавать лид** - настройка позволяет создавать лид по чатам. <br />
При её выборе выводятся дополнительные настройки:
- Выберите на какое событие создавать лид: начало чата, завершение чата, простановка тега.
- При выборе простановки тега дополнительно выводится список тегов. <br />
4.4. **Создавать задачу по потерянному чату** -  настройка создания задач по потерянным чатам:
- измените шаблон названия, при необходимости (через "+" можно добавить требуемые параметры)<br />
4.5. **Передавать чаты от посетителей без контактных данных** -  настройка позволяет создавать лид по чатам, в которых отсутствует номер телефона. При каждом новом чате с посетителем без контактных данных будет создаваться новый лид, что может привести к дублям в AlfaCRM.  <br />
   **Важно!** Текст переписки чата будет передан только при завершении чата. <br />
4.6. **Передавать дополнительные поля** - настройка позволяет передавать дополнительные поля в контрагента. <br />
При её выборе выводятся дополнительные настройки выбора сущности в AlfaCRM и соответствия их полей в AlfaCRM и UIS.
Добавьте все требуемые значения. Если требуется передавать значение в поля не только при первичных чатах (при создании клиента), но и при повторных, выберите настройку "Обновлять всегда".  <br />
