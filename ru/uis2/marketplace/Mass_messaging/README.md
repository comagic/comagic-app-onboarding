## Массовые рассылки <br />

Решение позволяет осуществлять массовую расслыку сообщений клиентам через канал WABA. <br />


## Подключение интеграции   <br /> 

1. При подключении интеграции в блоке “Прочие параметры интеграции” в выпадающем списке “Используемые каналы” выбираем нужный нам канал с которым планируем работать (важно: пока рассылки доступны только через канал WABA)  и нажимаем на кнопку сохранить. Таким образом мы подписываемся на канал, что позволяет далее использовать его при настройке рассылки. <br />
2. После успешного сохранения идем в блок “Настройки” и нажимаем на кнопку “Добавить”. После чего у нас открывается блок настроек для нашей рассылки. В нем включаем свич “Активность”. <br />
3. Заполняем необходимые настройки. <br />
3.1. **Имя настройки** - название нашей настройки (по которому в дальнейшем мы сможем отслеживать статус доставки сообщений по рассылке через отчет). <br />
3.2. **Тип обращения** - в выпадающем списке выбираем формат CSV, после чего необходимо будет подгрузить файл соответствующего формата в область загрузки файла. <br />
   <mark>**Важно!** Чтобы данные для отправки рассылки из файла были корректно обработаны, необходимо создать файл с учетом основных требований к формату:</mark>

   <mark>Файл должен быть загружен в формате csv, значения должны быть прописаны в строго указанном порядке: номер; дата и время отправки; переменная 1; переменная 2 и т.д. Все значения должны быть перечислены через ";". 
   Допустимый формат номера: 11 цифр, начинается с 7, например: 79207460022.
   Допустимый формат даты и времени: гггг-мм-дд чч:мм:сс, например: 2021-06-21 22:02:00
   Важно: дата и время отправки соответствует данным из личного кабинета пользователя, создающего рассылку.
   Переменные не являются обязательным значением и для них нет ограничений по формату. Добавлять переменные в файл нужно только при выборе шаблона с переменными для отправки.

   <mark>Пример того, как это должно выглядеть в файле:</mark>

   <mark>79207460022; 2021-06-21 22:02:00; покупатель; праздник <br />
   <mark>79256760044; 2021-06-20 21:02:00; покупатель; предложение <br />
   <mark>79456760044; 2021-06-19 20:02:00; покупатель; подарок <br />  </mark>
   
3.3. **Игнорировать дубли** - настройка позволяет исключить повторы номеров добавленных в файл. <br />
3.4. **Как связаться** - настройка определяет какой тип канала использовать для рассылки. <br />
3.5 **Канал связи** - настройка позволяет выбрать через какой канал будет осуществленна отправка(в случае с каналом WABA, сразу выбираем шаблон, который будем использовать в рассылке). <br />
3.6. **Добавить** - создает дополнительную копию настройки. <br />
5. После загрузки файла и выбора нужного канала, нажимаем на кнопку “Сохранить”, в этот момент у нас будет происходить проверка файла на корректность значений.
Если в файле будут найдены некорректные значения, отобразится всплывающее сообщение с информацией о том какие строки не были загружены и какие в них были ошибки.
После сохранения данные из файла записываются в систему и запускают рассылку в соответствии с датой и временем, указанными в файле csv. <br />
6. Чтобы посмотреть статус доставки, необходимо нажать на кнопку “Скачать отчет”, при нажатии будет скачан файл в формате excel на рабочий стол.<br />
В данном файле будет отображаться номер телефона на который должно прийти сообщение из рассылки, предполагаемая дата отправки, сценарий отправки (название рассылки), статус отправки и название шаблона который будет/был отправлен (для канала WABA). <br />
В РМО чаты с сообщениями из рассылки отобразятся только после получения ответа от клиента на сообщение из рассылки. <br />
7. **Проверить настройки** - поволяет проверить статусы каналов выбранных в настройках. Информация отобразится в блоке "Состояние настроек". <br />
